<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="public/css/style.css">
    <script src="public/js/script.js"></script>
    <script>
        function sendRequest(direction) {
            fetch('http://localhost:5000/move', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 'direction': direction })
                });
            }var keyState = {}; // To keep track of key states

        function handleKeyPress(event) {
            var keyCode = event.keyCode || event.which;
            if (keyCode === 65 && !keyState['A']) {  // 65 is the key code for the 'A' key
                keyState['A'] = true;
                sendRequest('left');
                document.getElementById('west').style.backgroundColor = 'green';
            } else if (keyCode === 87 && !keyState['W']) {  // 87 is the key code for the 'W' key
                keyState['W'] = true;
                sendRequest('front');
                document.getElementById('north').style.backgroundColor = 'green';
            } else if (keyCode === 68 && !keyState['D']) {  // 68 is the key code for the 'D' key
                keyState['D'] = true;
                sendRequest('right');
                document.getElementById('east').style.backgroundColor = 'green';
            } else if (keyCode === 83 && !keyState['S']) {  // 83 is the key code for the 'S' key
                keyState['S'] = true;
                sendRequest('back');
                document.getElementById('south').style.backgroundColor = 'green';
            }
        }

        function handleKeyRelease(event) {
            var keyCode = event.keyCode || event.which;
            sendRequest('parar');
            if (keyCode === 65) {  // 65 is the key code for the 'A' key
                delete keyState['A'];
                document.getElementById('west').style.backgroundColor = '';
            } else if (keyCode === 87) {  // 87 is the key code for the 'W' key
                delete keyState['W'];
                document.getElementById('north').style.backgroundColor = '';
            } else if (keyCode === 68) {  // 68 is the key code for the 'D' key
                delete keyState['D'];
                document.getElementById('east').style.backgroundColor = '';
            } else if (keyCode === 83) {  // 83 is the key code for the 'S' key
                delete keyState['S'];
                document.getElementById('south').style.backgroundColor = '';
            } 
            if (keyCode === 32) {  // 32 is the key code for the space bar
                sendRequest('parar');
            }
        }

        // Add event listeners for key press and key release events
        document.addEventListener("keydown", handleKeyPress);
        document.addEventListener("keyup", handleKeyRelease);
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head><body>
    <div class="container">
        <div class="row">
            <div class="col" style="text-align: center;"><h1>Central de controle Desencana!</h1></div>
        </div>
        <div class="row">
            <div class="col-md-3" style="text-align: center; margin: auto;">
                <button type="button" class="btn btn-secondary">Ligar robô</button>
            </div>
            <div class="col-md-6"">
                <img src="public/img/noSignal.jpg" alt="noSignal" width="75%" class="center">
            </div>
            <div class="col-md-3" style="text-align: center; margin: auto;">
                <button type="button" class="btn btn-secondary">Desligar robô</button>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="D-Pad">
                    <div class="btn-col"><button class="direction-button btn btn-secondary" id="north">Front</button></div>
                    <div class="btn-row">
                        <button class="direction-button btn btn-secondary" id="west">Left</button>
                        <div class="center">.</div>
                        <button class="direction-button btn btn-secondary" id="east">Right</button>
                    </div>
                    <div class="btn-col"><button class="direction-button btn btn-secondary" id="south">Back</button></div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>